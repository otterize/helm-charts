
# Parameters

## Deployment parameters

| Key                                     | Description                                                                                                                           | Default |
|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|---------|
| `global.deployment.spire`               | Whether or not to deploy SPIRE.  Required for mTLS, if not using Otterize Cloud.                                                      | `true`  |
| `global.deployment.credentialsOperator` | Whether or not to deploy credentials-operator. Required to provision mTLS credentials, database username/password, and AWS IAM roles. | `true`  |
| `global.deployment.intentsOperator`     | Whether or not to deploy intents-operator.                                                                                            | `true`  |
| `global.deployment.networkMapper`       | Whether or not to deploy network-mapper.                                                                                              | `true`  |

## Global parameters

These parameters are used by multiple charts, and must be kept the same for the correct functioning of the separate components.

| Key                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Default                             |
|--------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
| `global.spiffe.CASubject`                  | The Subject that CA certificates should use (see below).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                     |
| `global.spiffe.CASubject.country`          | SPIRE's CA certificates `Country` value.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `"US"`                              |
| `global.spiffe.CASubject.organization`     | SPIRE's CA certificates `Organization` Value.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `"SPIRE"`                           |
| `global.spiffe.trustDomain`                | The trust domain that SPIRE will use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"example.org"`                     |
| `global.certificateProvider`               | What provider should be used to generate certificates for mTLS - `"spire"`, `"otterize-cloud"` or `"cert-manager"`                                                                                                                                                                                                                                                                                                                                                                                                      | `"spire"`                           |
| `global.spire.serverServiceName`           | Name of the Kubernetes service that will be created for SPIRE-server.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                     |
| `global.allowGetAllResources`              | If defined overrides `allowGetAllResources` in subcharts. Gives get, list and watch permission to watch on all resources. This is used to resolve service names when pods have owners that are custom resources. When disabled, a limited set of permissions is used that only allows access to built-in Kubernetes resources that deploy Pods and Pods themselves - Deployments, StatefulSets, DaemonSets, ReplicaSets and Services. Resolving may not be able to complete if the owning resource is not one of those. |                                     |
| `global.commonAnnotations`                 | Annotations to add to all deployed objects                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | {}                                  |
| `global.commonLabels`                      | Labels to add to all deployed objects                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | {}                                  |
| `global.podAnnotations`                    | Annotations to add to all deployed pods                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | {}                                  |
| `global.podLabels`                         | Labels to add to all deployed pods                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | {}                                  |
| `global.serviceNameOverrideAnnotationName` | Which annotation to use (in the [service name resolution algorithm](https://docs.otterize.com/reference/service-identities#kubernetes-service-identity-resolution)) for setting a pod's service name, if not the default. Use this if you already have annotations on your pods that provide the correct service name.                                                                                                                                                                                                  | `intents.otterize.com/service-name` |
| `global.openshift`                         | Whether to configure and deploy SecurityContextConstraints that allow all components to run with minimal privileges on a default OpenShift installation.                                                                                                                                                                                                                                                                                                                                                                | `false`                             |

## Cloud parameters

| Key                                                              | Description                                                                                                                                                                                  | Default  |
|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| `global.otterizeCloud.credentials.clientId`                      | Client ID for connecting to Otterize Cloud.                                                                                                                                                  | `(none)` |
| `global.otterizeCloud.credentials.clientSecret`                  | Client secret for connecting to Otterize Cloud.                                                                                                                                              | `(none)` |
| `global.otterizeCloud.credentials.clientSecretKeyRef.secretName` | If specified, the name of a pre-created Kubernetes Secret to be used instead of creating a secret with the value of clientSecret.                                                            | `(none)` |
| `global.otterizeCloud.credentials.clientSecretKeyRef.secretKey`  | If specified, the key for the clientSecret in a pre-created Kubernetes Secret to be used instead of creating a secret with the value of clientSecret.                                        | `(none)` |
| `global.otterizeCloud.apiAddress`                                | Overrides Otterize Cloud default API address.                                                                                                                                                | `(none)` |
| `global.otterizeCloud.apiExtraCAPEMSecret`                       | The name of a secret containing a single `CA.pem` file for an extra root CA used to connect to Otterize Cloud. The secret should be placed in the same namespace as the Otterize deployment. | `(none)` |

## AWS Integration parameters

| Key                                 | Description                                                                                     | Default  |
|-------------------------------------|-------------------------------------------------------------------------------------------------|----------|
| `global.aws.enabled`                | Enable or disable AWS integration                                                               | `false`  |
| `global.aws.eksClusterNameOverride` | EKS cluster name (overrides auto-detection)                                                     | `(none)` |
| `global.aws.useSoftDelete`          | Use soft delete strategy (tag as deleted instead of actually delete) for AWS roles and policies | `false`  |

### AWS Integration - RolesAnywhere parameters

| Key                                    | Description                                                                                                                                                                                                                                                                                                                                                   | Default |
|----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| `global.aws.rolesAnywhere.enabled`     | Enable or disable AWS integration                                                                                                                                                                                                                                                                                                                             | `false` |
| `global.aws.rolesAnywhere.clusterName` | Cluster name to represent this cluster in resources created on AWS                                                                                                                                                                                                                                                                                            | `(nil)` |
| `global.aws.rolesAnywhere.accounts`    | List of AWS account objects, with the following fields: `id`, `trustAnchorARN`, `trustDomain`, and under `intentsOperator` or `credentialsOperator`, `roleARN`, `profileARN`. At least one account is required. If more than one is specified, the pod label `credentials-operator.otterize.com/create-aws-role`'s value must be the targeted AWS account ID. | `(nil)` |

## Azure Integration parameters

| Key                                   | Description                                                            | Default  |
|---------------------------------------|------------------------------------------------------------------------|----------|
| `global.azure.enabled`                | Enable or disable Azure integration                                    | `false`  |
| `global.azure.userAssignedIdentityID` | ID of the user assigned identity used by the operator to access Azure. | `(none)` |
| `global.azure.subscriptionID`         | ID of the Azure subscription in which the AKS cluster is deployed.     | `(none)` |
| `global.azure.resoureceGroup`         | Name of the Azure resource group in which the AKS cluster is deployed. | `(none)` |
| `global.azure.aksClusterName`         | Name of the AKS cluster in which the operator is deployed.             | `(none)` |

## Intents operator parameters

All configurable parameters of intents-operator can be configured under the alias `intentsOperator`.
Further information about intents-operator parameters can be found [in the Intents Operator's helm chart](https://github.com/otterize/helm-charts/tree/main/intents-operator).

| Key                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Default                                                  |
|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
| `intentsOperator.autoGenerateTLSUsingCredentialsOperator`  | Use credentials-operator to create TLS cert for intents-operator.                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                                                   |
| `operator.mode`                                            | `defaultActive` or `defaultShadow`. When `defaultActive` is set, enforcement is enabled by default. When `defaultShadow` is set, enforcement is disabled by default, but can be enabled per-service using a ProtectedService resource.                                                                                                                                                                                                                                                                     | `defaultActive`                                          |
| `intentsOperator.operator.enableEnforcement`               | (deprecated, use mode instead) If set to false, enforcement is disabled globally (both for network policies and Kafka ACL). If true, you may use the other flags for more granular enforcement settings                                                                                                                                                                                                                                                                                                    | `true`                                                   |
| `intentsOperator.operator.enableNetworkPolicyCreation`     | Whether the operator should create network policies according to the ClientIntents                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                   |
| `intentsOperator.operator.enableKafkaACLCreation`          | Whether the operator should create Kafka ACL rules according to the ClientIntents of type Kafka                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                   |
| `intentsOperator.operator.enableIstioPolicyCreation`       | Whether the operator should create Istio authorization policies according to ClientIntents                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                                                   |
| `intentsOperator.operator.ingressControllerConfigs`        | Restricts the automatically created external traffic network policies to only allow access to an ingress controller within the cluster. Only relevant if you use an in-cluster ingress controller, such as nginx or HAProxy. A list of objects with keys `name`, `namespace` and `kind`, such as `ingress-nginx-controller`, `nginx` and `Deployment`.                                                                                                                                                     | `(none)`                                                 |
| `intentsOperator.operator.ingressControllerAWSALBExempt`   | If set to true, the operator will allow all traffic if an Ingress is managed by the AWS ALB Ingress Controller.                                                                                                                                                                                                                                                                                                                                                                                            | `false`                                                  |
| `intentsOperator.operator.allowExternalTraffic`            | `ifBlockedByOtterize`, `off` or `always`. Specify how the operator handles external traffic for Ingress/Service resources: `ifBlockedByOtterize` automatically create network policies to enable internet traffic for services that would be blocked by Otterize network policies when protecting a server. Choosing `off` may necessitate manual network policy creation to allow external traffic, while `always` automatically creates policies for all such resource that are visible to the operator. | `ifBlockedByOtterize`                                    |
| `intentsOperator.operator.externallyManagedPolicyWorkload` | Workloads assumed to have externally managed network policies, allowing traffic to/from them. Otterize Cloud will not suggest new ClientIntents for these workloads.                                                                                                                                                                                                                                                                                                                                       | `(none)`                                                 |
| `intentsOperator.watchedNamespaces`                        | List of namespaces the intents operator should watch. The operator will be blind to any namespace not in this list.                                                                                                                                                                                                                                                                                                                                                                                        | `(nil) meaning watch all`                                |
| `intentsOperator.enforcedNamespaces`                       | When using "shadow enforcement" mode, namespaces in this list will be treated as if the enforcement were active.                                                                                                                                                                                                                                                                                                                                                                                           | `(nil) means no namespace will be active on shadow mode` |

## Telemetry

Otterize OSS components report anonymous usage information back to the Otterize team, to help the team understand how the software is used in the community and what aspects users find useful. No personal or organizational identifying information is transmitted in these metrics: they only reflect patterns of usage. You may opt out at any time through a single configuration flag.

| Key                                                 | Description                                                                                                                   | Default  |
|-----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|----------|
| `global.telemetry.enabled`                          | If set to `false`, all anonymous telemetries collection will be disabled                                                      | `true`   |
| `global.telemetry.usage.enabled`                    | If set to `false`, collection of anonymous telemetries on product usage will be disabled                                      | `true`   |
| `global.telemetry.errors.enabled`                   | If set to `false`, collection of anonymous telemetries on application crashes and errors will be disabled                     | `true`   |
| `global.telemetry.errors.endpointAddress`           | If set, overrides the default endpoint address for anonymous telemetries on application crashes and errors                    | `(none)` |
| `global.telemetry.errors.stage`                     | If set, overrides the default stage for anonymous telemetries on application crashes and errors                               | `(none)` |
| `global.telemetry.errors.networkMapperApiKey`       | If set, overrides the default API key for anonymous telemetries on application crashes and errors in the network mapper       | `(none)` |
| `global.telemetry.errors.credentialsOperatorApiKey` | If set, overrides the default API key for anonymous telemetries on application crashes and errors in the credentials operator | `(none)` |
| `global.telemetry.errors.intentsOperatorApiKey`     | If set, overrides the default API key for anonymous telemetries on application crashes and errors in the intents operator     | `(none)` |

## SPIRE parameters

All configurable parameters of SPIRE can be configured under the alias `spire`.
Further information about `SPIRE` parameters can be found [in SPIRE's helm chart](https://github.com/otterize/helm-charts/tree/main/spire).

## Network mapper parameters

All configurable parameters of the network mapper can be configured under the alias `networkMapper`.
Further information about network mapper parameters can be found [in the network mapper's chart](https://github.com/otterize/helm-charts/tree/main/network-mapper).

## Credentials operator parameters

All configurable parameters of the credentials operator can be configured under the alias `credentialsOperator`.
Further information about network mapper parameters can be found [in the credentials operator's chart](https://github.com/otterize/helm-charts/tree/main/credentials-operator).

## Resource configuration

| Component                  | Key                                  | Default  |
|----------------------------|--------------------------------------|----------|
| Intents Operator           | `intentsOperator.operator.resources` | `(none)` |
| Intents Operator - Watcher | `intentsOperator.watcher.resources`  | `(none)` |
| SPIRE Server               | `spire.server.resources`             | `(none)` |
| SPIRE Agent                | `spire.agent.resources`              | `(none)` |
| Credentials Operator       | `credentialsOperator.resources`      | `(none)` |
